from unittest import TestCase

from lib.xecrypt import XeCryptBnQw_SwapLeBe
from lib.xecrypt import XeCryptBnDw_SwapLeBe

class TestXeCryptBnQw_SwapLeBe(TestCase):

    def test_normal_1(self):
        self.assertEqual(XeCryptBnQw_SwapLeBe(
            bytes([0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08]), 1),
            bytes([0x08, 0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01]))

    def test_normal_2(self):
        self.assertEqual(XeCryptBnQw_SwapLeBe(
            bytes([0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,
                   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,
                   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08]), 3),
            bytes([0x08, 0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01,
                   0x08, 0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01,
                   0x08, 0x07, 0x06, 0x05, 0x04, 0x03, 0x02, 0x01]))

    def test_zero(self):
        self.assertEqual(XeCryptBnQw_SwapLeBe(
            bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), 1),
            bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]))

    def test_one(self):
        self.assertEqual(XeCryptBnQw_SwapLeBe(
        bytes([0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), 1),
        bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01]))

class TestXeCryptBnDw_SwapLeBe(TestCase):

    def test_normal_1(self):
        self.assertEqual(XeCryptBnDw_SwapLeBe(
            bytes([0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08]), 2),
            bytes([0x04, 0x03, 0x02, 0x01, 0x08, 0x07, 0x06, 0x05, ]))

    def test_normal_2(self):
        self.assertEqual(XeCryptBnDw_SwapLeBe(
            bytes([0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,
                   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08,
                   0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08]), 6),
            bytes([0x04, 0x03, 0x02, 0x01, 0x08, 0x07, 0x06, 0x05,
                   0x04, 0x03, 0x02, 0x01, 0x08, 0x07, 0x06, 0x05,
                   0x04, 0x03, 0x02, 0x01, 0x08, 0x07, 0x06, 0x05]))

    def test_zero(self):
        self.assertEqual(XeCryptBnDw_SwapLeBe(
            bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), 2),
            bytes([0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]))

    def test_one(self):
        self.assertEqual(XeCryptBnDw_SwapLeBe(
            bytes([0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]), 2),
            bytes([0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00]))

